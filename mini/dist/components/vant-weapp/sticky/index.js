(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[87],{246:function(t,e,n){"use strict";n.r(e);var o=n(6),r=n(5);function i(){var t=getCurrentPages();return t[t.length-1]||{}}function a(t){var e=i(),n=e.vanPageScroller,o=void 0===n?[]:n;o.forEach((function(e){"function"===typeof e&&e(t)}))}var c=function(t){return Behavior({attached:function(){var e=i();Array.isArray(e.vanPageScroller)?e.vanPageScroller.push(t.bind(this)):e.vanPageScroller="function"===typeof e.onPageScroll?[e.onPageScroll.bind(e),t.bind(this)]:[t.bind(this)],e.onPageScroll=a},detached:function(){var e=i();e.vanPageScroller=(e.vanPageScroller||[]).filter((function(e){return e!==t}))}})},f=".van-sticky";Object(r["a"])({props:{zIndex:{type:Number,value:99},offsetTop:{type:Number,value:0,observer:"onScroll"},disabled:{type:Boolean,observer:"onScroll"},container:{type:null,observer:"onScroll"},scrollTop:{type:null,observer:function(t){this.onScroll({scrollTop:t})}}},mixins:[c((function(t){null==this.data.scrollTop&&this.onScroll(t)}))],data:{height:0,fixed:!1,transform:0},mounted:function(){this.onScroll()},methods:{onScroll:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.scrollTop,r=this.data,i=r.container,a=r.offsetTop,c=r.disabled;c?this.setDataAfterDiff({fixed:!1,transform:0}):(this.scrollTop=n||this.scrollTop,"function"!==typeof i?this.getRect(f).then((function(e){a>=e.top?(t.setDataAfterDiff({fixed:!0,height:e.height}),t.transform=0):t.setDataAfterDiff({fixed:!1})})):Promise.all([this.getRect(f),this.getContainerRect()]).then((function(e){var n=Object(o["a"])(e,2),r=n[0],i=n[1];a+r.height>i.height+i.top?t.setDataAfterDiff({fixed:!1,transform:i.height-r.height}):a>=r.top?t.setDataAfterDiff({fixed:!0,height:r.height,transform:0}):t.setDataAfterDiff({fixed:!1,transform:0})})))},setDataAfterDiff:function(t){var e=this;wx.nextTick((function(){var n=Object.keys(t).reduce((function(n,o){return t[o]!==e.data[o]&&(n[o]=t[o]),n}),{});e.setData(n),e.$emit("scroll",{scrollTop:e.scrollTop,isFixed:t.fixed||e.data.fixed})}))},getContainerRect:function(){var t=this.data.container();return new Promise((function(e){return t.boundingClientRect(e).exec()}))}}})}},[[246,0,1,2]]]);