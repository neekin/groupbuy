(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[138],{136:function(e,t,a){},236:function(e,t,a){"use strict";a.r(t);var n=a(3),r=a(7),c=a.n(r),s=a(11),i=a(6),l=a(0),o=a(1),u=a(2),p=a.n(u),d=a(27),f=a(34);function m(){return Object(f["c"])(function(){var e=Object(s["a"])(c.a.mark((function e(t){var a,n,r,i,l;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=p.a.cloud.database(),n=a.collection("User"),e.next=4,p.a.cloud.callFunction({name:"openid",data:{}});case 4:return r=e.sent,i=r.result,l=i.openid,t.openid=l,e.abrupt("return",new Promise(function(){var e=Object(s["a"])(c.a.mark((function e(a,r){var s,i;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.where({openid:t.openid}).orderBy("openid","asc").get();case 3:if(s=e.sent,0!==s.data.length){e.next=12;break}return t.createdAt=(new Date).getTime(),t.updatedAt=(new Date).getTime(),e.next=9,n.add({data:t});case 9:i=e.sent,e.next=13;break;case 12:i=s.data[0];case 13:p.a.setStorage({key:"userInfo",data:i}),a(i),e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](0),r(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t,a){return e.apply(this,arguments)}}()));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var b=a(35),v=a(19),g=a(29);a(136);function w(e){var t=Object(g["a"])(),a=t.mutate,n=m(),r=Object(i["a"])(n,2),u=r[0],f=r[1].isLoading,w=function(){var e=Object(s["a"])(c.a.mark((function e(t){var n;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.detail.userInfo,e.prev=1,e.next=4,u(n);case 4:d["a"].success("\u6388\u6743\u6210\u529f~"),a(),p.a.switchTab({url:"/pages/index/index"}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),d["a"].fail(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return l["createElement"](o["f"],{className:"login"},l["createElement"]("van-sticky",null,l["createElement"](v["a"],{back:!1,title:"\u767b\u5f55",style:{backgroundColor:"white"}})),l["createElement"](o["f"],{className:"wapper"},l["createElement"](o["f"],{className:"title"},"\u5c31\u5dee\u4e00\u6b65\u5566"),l["createElement"](o["f"],{className:"sub-title"},"\u83b7\u53d6\u60a8\u7684\u516c\u5f00\u4fe1\u606f\uff08\u6635\u79f0\u3001\u5934\u50cf\u7b49\uff09"),l["createElement"](o["f"],{className:"desc"},"\u9700\u83b7\u53d6\u516c\u5f00\u4fe1\u606f\uff0c\u65b9\u4fbf\u60a8\u4f7f\u7528",b["miniTitle"],"\u7684\u5168\u90e8\u529f\u80fd"),l["createElement"](o["f"],{className:"btn"},l["createElement"]("van-button",{loading:f,loadingText:"\u767b\u5f55\u4e2d...",block:!0,type:"primary",openType:"getUserInfo",onGetUserInfo:w},"\u6388\u6743\u516c\u5f00\u4fe1\u606f")),l["createElement"](o["f"],{className:"btn"},l["createElement"]("van-button",{block:!0,type:"default",onClick:function(){p.a.switchTab({url:"/pages/index/index"})}},"\u6682\u4e0d\u767b\u5f55")),l["createElement"](o["f"],{className:"link"},l["createElement"]("van-button",{customClass:"contact",type:"default",openType:"contact"},"\u767b\u5f55\u4e0d\u4e0a\uff1f\u70b9\u51fb\u8054\u7cfb\u5ba2\u670d\uff01"))),l["createElement"]("van-toast",{id:"van-toast"}))}var x={navigationBarTitleText:"\u767b\u5f55"};Page(Object(n["createPageConfig"])(w,"pages/login/login",{},x||{}))}},[[236,0,3,1,2]]]);